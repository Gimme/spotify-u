(this["webpackJsonpspotify-u"]=this["webpackJsonpspotify-u"]||[]).push([[0],{20:function(e,t,n){},27:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},53:function(e,t,n){e.exports=n(76)},58:function(e,t,n){},76:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(15),c=n.n(o),i=(n(58),n(9)),l=n(50),s=n(23),u=n.n(s),m=n(49),d=n(12),f=Object(d.a)(),h=new m.a,p=function(){g()},g=function(){var e=h.get("access_token");if(void 0!==e)return Promise.resolve(e);var t,n=function(){var e=u.a.parse(window.location.search),t=e.access_token,n=e.refresh_token,a=e.expires_in,r=Object(l.a)(e,["access_token","refresh_token","expires_in"]);return function(e){window.history.replaceState(null,"",window.location.href.replace(window.location.search,(""!==e?"?":"")+e))}(u.a.stringify(r)),window.location.hash=window.location.hash.replace("_=_",""),{access_token:t,expires_in:a,refresh_token:n}}();return e=n.access_token,void 0!==(t=e)&&null!==t&&""!==t?(k(e,n.refresh_token),Promise.resolve(e)):(E(),null)},v=function(){if(void 0===h.get("recently_refreshed_access_token")){var e=h.get("refresh_token");void 0!==e&&(console.log("Refreshing access token..."),fetch("https://spotify-u-backend.herokuapp.com/refresh_token?refresh_token="+e).then((function(e){return e.json()})).then((function(t){console.log("Refreshed access token"),k(t.access_token,e)})))}};function E(){f.push("/loading"),window.location.replace("https://spotify-u-backend.herokuapp.com/login")}function k(e,t){h.set("access_token",e,{path:"/",maxAge:3600}),h.set("refresh_token",t,{path:"/",maxAge:3600}),h.set("recently_refreshed_access_token","",{path:"/",maxAge:900})}function y(e,t){var n=g();return null===n?Promise.resolve(null):n.then((function(n){return fetch("https://api.spotify.com/v1/"+e+(t?"?"+u.a.stringify(t):""),{headers:{Authorization:"Bearer "+n}})})).then(w)}function w(e){var t=e.status;if(204===t)return Promise.resolve(null);var n=e.json();return Promise.all([t,n]).then((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];return 401===n?(h.remove("access_token"),E(),null):200===n?a:null}))}var b=n(27),_=n.n(b),j=(n(20),n(103)),I=n(100),S=n(102),x=n(38),O=n(108),C=n(109),N=n(48);function P(e){var t=e.index,n=e.style,a=e.data.items[t];return r.a.createElement(O.a,{button:!0,style:n,key:t,selected:e.data.selectedIndex===t,onClick:function(){e.data.onItemClick&&a&&e.data.onItemClick(a,t)}},r.a.createElement(C.a,{primaryTypographyProps:{noWrap:!0},primary:e.data.getText(a)}))}var T=function(e){var t=Object(a.useState)(null),n=Object(i.a)(t,2),o=n[0],c=n[1],l={selectedIndex:o,onItemClick:function(t,n){var a=n===o;c(n),e.onItemClick&&e.onItemClick(t,n),!a&&e.onItemSelected&&e.onItemSelected(t,n)},items:e.items,getText:e.getText};return r.a.createElement("div",null,r.a.createElement(N.a,{itemData:l,height:e.height,width:"100%",itemSize:e.itemSize,itemCount:e.itemCount?e.itemCount:l.items.length,onItemsRendered:e.onItemsRendered,ref:e.reff},P))},A=n(45),z=[];var B=function(e){function t(t){return t?e.getText(t):"Loading..."}return r.a.createElement(A.a,{isItemLoaded:function(t){return!!e.items[t]},itemCount:e.items.length,loadMoreItems:function(t,n){return z[t]?Promise.resolve():(z[t]=!0,e.loadItems(t))}},(function(n){var a=n.onItemsRendered,o=n.ref;return r.a.createElement(T,{onItemsRendered:a,reff:o,height:e.height,itemSize:e.itemSize,items:e.items,itemCount:e.items.length,getText:t,onItemSelected:e.onItemSelected,onItemClick:e.onItemClick})}))},R=n(101),W=Object(I.a)((function(e){return{root:{minWidth:e.spacing(22),margin:e.spacing(3),backgroundColor:e.palette.grey[900]}}})),L=function(e){var t=W(),n=Object(a.useState)([]),o=Object(i.a)(n,2),c=o[0],l=o[1],s=Object(a.useState)(0),u=Object(i.a)(s,2),m=u[0],d=u[1],f=Object(a.useState)(null),h=Object(i.a)(f,2),p=h[0],g=h[1];Object(a.useEffect)((function(){y("me").then((function(e){return e?e.id:null})).then((function(e){g(e),l((function(e){return[].concat(Object(x.a)(e),[null])}))}))}),[]);return r.a.createElement(R.a,{elevation:3,className:t.root},r.a.createElement(B,{height:600,itemSize:46,items:c,getText:function(e){return e?e.name:"Loading..."},loadItems:function(e){return p?(t=40,n=e+m,y("me/playlists",{limit:t,offset:n}).then((function(e){return e||null}))).then((function(e){if(e&&0!==e.items.length){var t=e.items.filter((function(e){return e.owner.id===p}));d(m+e.items.length-t.length),l((function(e){return e.filter((function(e){return!!e})).concat([].concat(Object(x.a)(t),[null]))}))}else l((function(e){return e.filter((function(e){return!!e}))}))})):(l((function(e){return e.filter((function(e){return!!e}))})),Promise.resolve());var t,n},onItemSelected:e.onPlaylistSelected}))},J=Object(I.a)((function(e){return{root:{display:"flex"},app:{width:"100%",justifyContent:"center"},header:{width:"100%",justifyContent:"center",paddingTop:e.spacing(3)},content:{paddingTop:e.spacing(3)},sideBar:{width:"100%",maxWidth:e.spacing(40)}}})),M=function(){var e=J(),t=Object(a.useState)(null),n=Object(i.a)(t,2),o=n[0],c=n[1],l=Object(a.useState)(null),s=Object(i.a)(l,2),u=s[0],m=s[1];Object(a.useEffect)((function(){d()}),[]);var d=function(){y("me/player/currently-playing").then((function(e){return e&&e.item?e.item.name:null})).then((function(e){c(e)}))};return r.a.createElement("div",{className:e.root},r.a.createElement("div",{className:e.sideBar},r.a.createElement(L,{onPlaylistSelected:function(e,t){m(e)}})),r.a.createElement("div",{className:e.app},u?r.a.createElement("div",null,r.a.createElement("div",{className:e.header},u?r.a.createElement("div",null,r.a.createElement("img",{height:300,src:u.images[0].url,alt:"Playlist Cover"}),r.a.createElement("h1",null,u.name)):r.a.createElement("img",{src:_.a,className:"App-logo",alt:"logo"}),r.a.createElement("p",null)),r.a.createElement(S.a,{variant:"middle"}),r.a.createElement("div",{className:e.content},r.a.createElement(j.a,{color:"primary",variant:"outlined",onClick:d},"Show Current Song"),r.a.createElement("h1",null,o||"-No song is currently playing-"))):r.a.createElement("div",{className:e.header},r.a.createElement("h1",null,"Select a playlist"))),r.a.createElement("div",{className:e.sideBar}))},D=function(){return r.a.createElement("div",{className:"App"},r.a.createElement("img",{src:_.a,className:"App-logo",alt:"logo"}),r.a.createElement("h1",null,"Loading..."))},$=n(107),q=n(106),F=n(105),G=n(47),H=n(46),K=n.n(H),Q=n(104),U=Object(G.a)({palette:{type:"dark",background:{default:"#181818"},primary:Q.a,secondary:K.a,grey:{800:"#282828",900:"#121212"}}});var V=function(){return p(),v(),window.setInterval((function(){v()}),6e4),r.a.createElement("div",{className:"outerWrap"},r.a.createElement(F.a,{theme:U},r.a.createElement(q.a,null),r.a.createElement($.b,{history:f},r.a.createElement("div",{className:"App"},r.a.createElement($.c,null,r.a.createElement($.a,{path:"/",exact:!0,component:M}),r.a.createElement($.a,{path:"/loading",exact:!0,component:D}),r.a.createElement($.a,{path:"/auth",exact:!0,component:function(){return p(),null}}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(V,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[53,1,2]]]);
//# sourceMappingURL=main.209f0bc2.chunk.js.map