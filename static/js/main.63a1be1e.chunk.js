(this["webpackJsonpspotify-u"]=this["webpackJsonpspotify-u"]||[]).push([[0],{29:function(e,t,a){},35:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},69:function(e,t,a){e.exports=a(92)},74:function(e,t,a){},92:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(17),c=a.n(i),o=(a(74),a(11)),l=a(6),s=a(61),u=a(32),d=a.n(u),m=a(60),f=a(14),h=Object(f.a)(),p=new m.a,g=function(){v()},v=function(){var e=p.get("access_token");if(void 0!==e)return Promise.resolve(e);var t,a=function(){var e=d.a.parse(window.location.search),t=e.access_token,a=e.refresh_token,n=e.expires_in,r=Object(s.a)(e,["access_token","refresh_token","expires_in"]);return function(e){window.history.replaceState(null,"",window.location.href.replace(window.location.search,(""!==e?"?":"")+e))}(d.a.stringify(r)),window.location.hash=window.location.hash.replace("_=_",""),{access_token:t,expires_in:n,refresh_token:a}}();return e=a.access_token,void 0!==(t=e)&&null!==t&&""!==t?(E(e,a.refresh_token),Promise.resolve(e)):(k(),null)},b=function(){if(void 0===p.get("recently_refreshed_access_token")){var e=p.get("refresh_token");void 0!==e&&(console.log("Refreshing access token..."),fetch("https://spotify-u-backend.herokuapp.com/refresh_token?refresh_token="+e).then((function(e){return e.json()})).then((function(t){console.log("Refreshed access token"),E(t.access_token,e)})))}};function k(){h.push("/loading"),window.location.replace("https://spotify-u-backend.herokuapp.com/login")}function E(e,t){p.set("access_token",e,{path:"/",maxAge:3600}),p.set("refresh_token",t,{path:"/",maxAge:3600}),p.set("recently_refreshed_access_token","",{path:"/",maxAge:900})}var y=function(e){return function e(t,a,n){return O("playlists/".concat(t.id,"/tracks"),{limit:100,offset:a}).then((function(r){return r?(n=n.concat(r.items),r.next?e(t,a+100,n):Promise.resolve(n)):null}))}(e,0,[])};var j=function(e){return function e(t,a){if(0===a.length)return Promise.resolve(t);var n,r="",i=[],c=0,l=Object(o.a)(a);try{for(l.s();!(n=l.n()).done;){var s=n.value;c<50?(0!==r.length&&(r+=","),r+=s.track.id):i.push(s),c++}}catch(u){l.e(u)}finally{l.f()}return O("me/tracks/contains",{ids:r}).then((function(a){return a?(t=t.concat(a),0===i.length?Promise.resolve(t):e(t,i)):null}))}([],e)};function O(e,t,a,n){var r=v();return null===r?Promise.resolve(null):r.then((function(r){return fetch("https://api.spotify.com/v1/"+e+(t?"?"+d.a.stringify(t):""),{headers:{Authorization:"Bearer "+r,"Content-Type":"application/json"},method:a,body:JSON.stringify(n)})})).then(w)}function w(e){var t=e.status;if(204===t)return Promise.resolve(null);var a=e.json();return Promise.all([t,a]).then((function(e){var t=Object(l.a)(e,2),a=t[0],n=t[1];return 401===a?(p.remove("access_token"),k(),null):200===a?n:null}))}var N=a(35),x=a.n(N),C=(a(29),a(125)),I=a(118),S=a(120),_=a(134),P=a(117),L=a(59),T=a(131),W=function(e){var t=Object(n.useState)(!0),a=Object(l.a)(t,2),i=a[0],c=a[1];return Object(n.useEffect)((function(){var t=setTimeout((function(){c(!1)}),e.wait);return function(){clearTimeout(t)}}),[e.wait]),i?null:r.a.createElement(r.a.Fragment,null,e.children)},R=a(116);function z(e){return r.a.createElement(W,{wait:e.wait?e.wait:500},r.a.createElement(R.a,{size:e.size,className:e.className}))}function M(e){var t,a=e.index,n=e.style,i=e.data.items[a],c=!e.data.isItemLoaded||e.data.isItemLoaded(a);return t=!!e.data.isLoading&&e.data.isLoading?r.a.createElement(_.a,{style:{height:56},key:a},r.a.createElement(T.a,{justifyContent:"center",width:"100%",display:"flex"},r.a.createElement(z,null))):c?r.a.createElement(_.a,{button:!0,key:a,selected:e.data.selectedIndex===a,onClick:function(){e.data.onItemClick&&i&&e.data.onItemClick(i,a)}},r.a.createElement(P.a,{primaryTypographyProps:{noWrap:!0},primary:e.data.getText(i)})):null,r.a.createElement("div",{style:n},t)}var A=function(e){var t=Object(n.useState)(null),a=Object(l.a)(t,2),i=a[0],c=a[1],o={selectedIndex:i,onItemClick:function(t,a){var n=a===i;c(a),e.onItemClick&&e.onItemClick(t,a),!n&&e.onItemSelected&&e.onItemSelected(t,a)},items:e.items,getText:e.getText,isLoading:e.isLoading,isItemLoaded:e.isItemLoaded};return r.a.createElement("div",null,r.a.createElement(L.a,{itemData:o,height:e.height,width:"100%",itemSize:e.itemSize,itemCount:e.itemCount?e.itemCount:o.items.length,onItemsRendered:e.onItemsRendered,ref:e.reff},M))},D=a(56);var B=function(e){var t=e.hasNextPage?e.items.length+1:e.items.length,a=e.isNextPageLoading?function(){return Promise.resolve()}:e.loadNextPage,n=function(t){return!e.hasNextPage||t<e.items.length};function i(t){return e.getText(t)}return r.a.createElement(D.a,{isItemLoaded:n,itemCount:t,loadMoreItems:a},(function(a){var c=a.onItemsRendered,o=a.ref;return r.a.createElement(A,{isLoading:e.isNextPageLoading,isItemLoaded:n,onItemsRendered:c,reff:o,height:e.height,itemSize:e.itemSize,items:e.items,itemCount:t,getText:i,onItemSelected:e.onItemSelected,onItemClick:e.onItemClick})}))},F=a(119),J=Object(I.a)((function(e){return{root:{minWidth:e.spacing(22),margin:e.spacing(3),backgroundColor:e.palette.grey[900]},header:{color:e.palette.primary.main,display:"flex",alignItems:"center",paddingLeft:e.spacing(2),height:e.spacing(6)}}})),Y=function(e){var t=J(),a=Object(n.useState)([]),i=Object(l.a)(a,2),c=i[0],o=i[1],s=Object(n.useState)(0),u=Object(l.a)(s,2),d=u[0],m=u[1],f=Object(n.useState)(null),h=Object(l.a)(f,2),p=h[0],g=h[1],v=Object(n.useState)(!1),b=Object(l.a)(v,2),k=b[0],E=b[1],y=Object(n.useState)(!0),j=Object(l.a)(y,2),w=j[0],N=j[1];Object(n.useEffect)((function(){O("me").then((function(e){return e?e.id:null})).then((function(e){x(e,0),g(e)}))}),[]);var x=function(e,t){if(!e)return Promise.resolve();E(!0);var a,n;return(a=40,n=t+d,O("me/playlists",{limit:a,offset:n}).then((function(e){return e||null}))).then((function(t){if(E(!1),t){t.items.length<40&&N(!1);var a=t.items.filter((function(t){return t.owner.id===e}));m(d+t.items.length-a.length),o((function(e){return e.concat(a)}))}else N(!1)}))};return r.a.createElement(F.a,{elevation:3,className:t.root},r.a.createElement("div",{className:t.header},r.a.createElement("h2",null,"Playlists")),r.a.createElement(S.a,null),r.a.createElement(B,{hasNextPage:w,isNextPageLoading:k,height:784,itemSize:46,items:c,getText:function(e){return e.name},loadNextPage:function(e){return x(p,e)},onItemSelected:e.onPlaylistSelected}))},$=a(57);function q(e,t){var a={sensitivity:"base"};return 2*e.track.artists[0].name.localeCompare(t.track.artists[0].name,"en",a)+1*e.track.name.localeCompare(t.track.name,"en",a)}var G=a(48),H=a(133),K=a(126),Q=function(e){return new Date(Date.parse(e.added_at))},U=a(121),V=a(122),X=a(132),Z=Object(I.a)((function(e){return Object(H.a)({root:{width:"100%"}})}));function ee(e){var t=Z();return r.a.createElement(U.a,{className:t.root},e.items.map((function(t,a){var n="checkbox-list-label-".concat(a);return r.a.createElement(_.a,{key:a,role:void 0,dense:!0,button:!0,divider:!0,className:e.listItemClassName&&e.listItemClassName(a),onClick:function(){return e.handleToggle(a)}},r.a.createElement(V.a,null,r.a.createElement(X.a,{edge:"start",checked:e.isChecked(a),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":n}})),e.getContent(t))})))}var te=a(42),ae=a(123),ne=a(124),re=Object(I.a)((function(e){return Object(H.a)({root:{width:"100%",display:"flex",alignItems:"center"},liked:{width:"3%",display:"flex",alignItems:"center",minWidth:e.spacing(5),paddingRight:e.spacing(2)},title:{width:"34%",minWidth:e.spacing(20),paddingRight:e.spacing(2)},artist:{width:"25%",minWidth:e.spacing(15),paddingRight:e.spacing(2)},album:{width:"20%",minWidth:e.spacing(15),paddingRight:e.spacing(2)},addedAt:{width:"13%",minWidth:e.spacing(13),paddingRight:e.spacing(2)},duration:{width:"5%",minWidth:e.spacing(5),display:"flex",justifyContent:"flex-end"}})}));var ie=function(e){var t=re();return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.liked},void 0===e.track.liked?null:e.track.liked?r.a.createElement(ae.a,{fontSize:"small"}):r.a.createElement(ne.a,{fontSize:"small"})),r.a.createElement("div",{className:t.title},r.a.createElement(te.a,{noWrap:!0},e.track.track.name)),r.a.createElement("div",{className:t.artist},r.a.createElement(te.a,{noWrap:!0},function(e){var t,a="",n=Object(o.a)(e.track.artists);try{for(n.s();!(t=n.n()).done;){var r=t.value;0!==a.length&&(a+=", "),a+=r.name}}catch(i){n.e(i)}finally{n.f()}return a}(e.track))),r.a.createElement("div",{className:t.album},r.a.createElement(te.a,{noWrap:!0},e.track.track.album.name)),r.a.createElement("div",{className:t.addedAt},r.a.createElement(te.a,{noWrap:!0},function(e){var t=(Date.now()-e.getTime())/1e3,a=Math.round(t);if(0===a)return"just now";if(1===a)return"a second ago";if(a<60)return a+" seconds ago";var n=Math.round(t/60);if(1===n)return"a minute ago";if(n<60)return n+" minutes ago";var r=Math.round(t/3600);if(1===r)return"an hour ago";if(r<24)return r+" hours ago";var i=Math.round(t/86400);return 1===i?"a day ago":i<16?i+" days ago":e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)}(Q(e.track)))),r.a.createElement("div",{className:t.duration},r.a.createElement(te.a,{noWrap:!0},function(e){var t=Math.round(e/1e3),a=Math.floor(t/3600),n=Math.floor((t-3600*a)/60),r=t-3600*a-60*n;return(a>0?a+":":"")+((a>0&&n<10?"0":"")+n)+":"+((r<10?"0":"")+r)}(e.track.track.duration_ms))))},ce=Object(I.a)((function(e){return{buttonProgress:{position:"absolute"}}}));function oe(e){var t=ce();return r.a.createElement(C.a,{color:e.color,variant:e.variant,startIcon:e.startIcon,disabled:e.loadingCondition||e.disabled,className:e.className,onClick:e.onClick},e.children,e.loadingCondition&&r.a.createElement(z,{className:t.buttonProgress,size:24,wait:300}))}var le=Object(I.a)((function(e){return Object(H.a)({root:{backgroundColor:e.palette.background.default},header:{color:e.palette.primary.main,display:"flex",alignItems:"center",paddingLeft:e.spacing(2),height:e.spacing(6)},button:{margin:e.spacing(1),marginBottom:e.spacing(10)},list:{position:"relative",width:"100%"},checkedListItem:{backgroundColor:e.palette.secondary.main+"08"}})}));var se=function(e){var t=le(),a=Object(n.useState)(function(e){var t,a=[],n=Object(o.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;a.push.apply(a,Object(G.a)(r))}}catch(i){n.e(i)}finally{n.f()}return a}(e.duplicates)),i=Object(l.a)(a,2),c=i[0],s=i[1],u=Object(n.useState)(function(e){var t,a=[],n=0,r=Object(o.a)(e);try{for(r.s();!(t=r.n()).done;){var i,c=t.value,l=-1,s=Date.now(),u=Object(o.a)(c);try{for(u.s();!(i=u.n()).done;){var d=i.value,m=Q(d).getTime();l<0?(l=n,s=m):m<s?(a.push(l),l=n,s=m):a.push(n),n++}}catch(f){u.e(f)}finally{u.f()}}}catch(f){r.e(f)}finally{r.f()}return a}(e.duplicates)),d=Object(l.a)(u,2),m=d[0],f=d[1],h=Object(n.useState)(!1),p=Object(l.a)(h,2),g=p[0],v=p[1],b=function(e){return-1!==m.indexOf(e)},k=function(){v(!0);for(var t=[],a=[],n=0;n<c.length;n++){var r=c[n];b(n)?t.push(r):a.push(r)}(function e(t,a,n){var r,i=[],c=[],l=0,s=Object(o.a)(a);try{for(s.s();!(r=s.n()).done;){var u=r.value;++l>100?c.push(u):u.position?i.push({uri:u.track.uri,positions:[u.position]}):console.error("Missing track position")}}catch(d){s.e(d)}finally{s.f()}return O("playlists/".concat(t.id,"/tracks"),void 0,"DELETE",{tracks:i,snapshot_id:n}).then((function(a){return!!a&&(0===c.length||e(t,c,a.snapshot_id))}))})(e.playlist,t,e.duplicatesSnapshotId).then((function(e){v(!1),e&&(f([]),s(a))}))};return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.header},r.a.createElement("h2",null,"Found ",e.duplicates.length," songs with duplicates:")),r.a.createElement(S.a,null),r.a.createElement("div",{className:t.list},r.a.createElement(ee,{items:c,isChecked:function(e){return b(e)},handleToggle:function(e){var t=m.indexOf(e),a=Object(G.a)(m);-1===t?a.push(e):a.splice(t,1),f(a)},listItemClassName:function(e){return b(e)?t.checkedListItem:""},getContent:function(e){return r.a.createElement(ie,{track:e})}})),r.a.createElement("div",null,r.a.createElement(oe,{color:"secondary",variant:"contained",className:t.button,startIcon:r.a.createElement(K.a,null),disabled:0===m.length,loadingCondition:g,onClick:function(){return k()}},"Delete (",m.length,")")))},ue=Object(I.a)((function(e){return{root:{display:"flex"},app:{width:"100%",justifyContent:"center"},header:{width:"100%",justifyContent:"center",paddingTop:e.spacing(3)},content:{paddingTop:e.spacing(3)},sideBar:{width:"100%",maxWidth:e.spacing(40)},button:{margin:e.spacing(1)}}})),de=function(){var e=ue(),t=Object(n.useState)(null),a=Object(l.a)(t,2),i=a[0],c=a[1],s=Object(n.useState)(null),u=Object(l.a)(s,2),d=u[0],m=u[1],f=Object(n.useState)(null),h=Object(l.a)(f,2),p=h[0],g=h[1],v=Object(n.useState)(null),b=Object(l.a)(v,2),k=b[0],E=b[1],w=Object(n.useState)(!1),N=Object(l.a)(w,2),I=N[0],_=N[1];Object(n.useEffect)((function(){P()}),[]);var P=function(){O("me/player/currently-playing").then((function(e){return e&&e.item?e.item.name:null})).then((function(e){c(e)}))};return r.a.createElement("div",{className:e.root},r.a.createElement("div",{className:e.sideBar},r.a.createElement(Y,{onPlaylistSelected:function(e,t){m(e),g(null)}})),r.a.createElement("div",{className:e.app},d?r.a.createElement("div",null,r.a.createElement("div",{className:e.header},d?r.a.createElement("div",null,r.a.createElement("img",{height:300,src:d.images[0].url,alt:"Playlist Cover"}),r.a.createElement("h1",null,d.name)):r.a.createElement("img",{src:x.a,className:"App-logo",alt:"logo"}),r.a.createElement("p",null)),r.a.createElement(S.a,{variant:"middle"}),r.a.createElement("div",{className:e.content},r.a.createElement(oe,{color:"primary",variant:"contained",className:e.button,loadingCondition:I,onClick:function(){d&&(_(!0),y(d).then((function(e){if(e){var t,a=e;(t=d.id,O("playlists/".concat(t)).then((function(e){return e||null}))).then((function(e){if(e){for(var t=e.snapshot_id,n=0;n<a.length;n++)a[n].position=n;var r,i=function(e){for(var t,a,n=e.slice().sort(q),r=[],i=0;i<n.length;i++){var c=n[i];if(c){for(var o=c.track.name,l=c.track.artists[0].name,s=[],u=!0,d=i+1;d<n.length;d++){var m=n[d];if(m){if(m.track.artists[0].name!==l)break;t=m.track.name,a=o,Object($.compareTwoStrings)(t,a)>=.8&&(u&&(u=!1,s.push(c)),s.push(m),n[d]=null)}}s.length>0&&r.push(s)}}return r}(a),c=[],l=Object(o.a)(i);try{for(l.s();!(r=l.n()).done;){var s,u=r.value,d=Object(o.a)(u);try{for(d.s();!(s=d.n()).done;){var m=s.value;c.push(m)}}catch(f){d.e(f)}finally{d.f()}}}catch(f){l.e(f)}finally{l.f()}j(c).then((function(e){if(_(!1),e){for(var a=0;a<e.length;a++)c[a].liked=e[a];g(null),g(i),E(t)}}))}else _(!1)}))}else _(!1)})))}},"Find Duplicate Songs"),r.a.createElement(C.a,{color:"primary",variant:"outlined",className:e.button,onClick:P},"Show Current Song"),r.a.createElement("h1",null,i||"-No song is currently playing-"),r.a.createElement("div",null,p?r.a.createElement(se,{playlist:d,duplicates:p,duplicatesSnapshotId:k||d.snapshot_id}):null))):r.a.createElement("div",{className:e.header},r.a.createElement("h1",null,"Select a playlist"))),r.a.createElement("div",{className:e.sideBar}))},me=function(){return r.a.createElement("div",{className:"App"},r.a.createElement("img",{src:x.a,className:"App-logo",alt:"logo"}),r.a.createElement("h1",null,"Loading..."))},fe=a(130),he=a(129),pe=a(128),ge=a(58),ve=a(127),be=a(41),ke=Object(ge.a)({palette:{type:"dark",background:{default:"#181818"},primary:ve.a,secondary:be.a,grey:{800:"#282828",900:"#121212"}}});var Ee=function(){return g(),b(),window.setInterval((function(){b()}),6e4),r.a.createElement("div",{className:"outerWrap"},r.a.createElement(pe.a,{theme:ke},r.a.createElement(he.a,null),r.a.createElement(fe.b,{history:h},r.a.createElement("div",{className:"App"},r.a.createElement(fe.c,null,r.a.createElement(fe.a,{path:"/",exact:!0,component:de}),r.a.createElement(fe.a,{path:"/loading",exact:!0,component:me}),r.a.createElement(fe.a,{path:"/auth",exact:!0,component:function(){return g(),null}}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Ee,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[69,1,2]]]);
//# sourceMappingURL=main.63a1be1e.chunk.js.map